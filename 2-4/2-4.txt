⚫️課題2−4


①顧客テーブルからすべての顧客の情報を取得するSQL文
「SELECT * FROM customers」


②顧客テーブルから特定の顧客の名前(山田太郎)とメールアドレス(yamada@example.com)を取得するSQL文
「SELECT * FROM customers WHERE name = '山田太郎' AND email = 'yamada@example.com'」


③注文テーブルから注文日が2022年2月1日以降の注文情報を取得するSQL文
「SELECT * FROM orders WHERE order_date >= '2022/2/1'」


④注文アイテムテーブルから、エアコン を購入した注文数を取得し注文された合計金額を取得するSQL文 ※LEFT JOINを利用すること
「SELECT sum(a.price) FROM order_items a LEFT JOIN products b ON a.product_id = b.product_id WHERE b.name = 'エアコン'」


⑤製品テーブルから、ある価格帯(5万円以上〜10万円以内)の製品を全て取得するSQL文
※BETWEENを利用すること
「SELECT * FROM products WHERE price BETWEEN 50000 AND 100000」


⑥製品テーブルから、カテゴリごとに製品数と平均価格を取得するSQL文
「SELECT category,avg(price),count(category) FROM products GROUP BY category」


⑦注文情報テーブルから、各顧客が最も最近に注文した日付を取得するSQL文
「SELECT a.name,a.customer_id,newday FROM customers a 
  INNER JOIN ( 
     SELECT MAX(b.order_date) newday
     ,b.customer_id
     FROM orders b GROUP BY b.customer_id
     ) b ON a.customer_id = b.customer_id」

